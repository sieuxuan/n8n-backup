{
  "active": true,
  "activeVersion": {
    "updatedAt": "2025-12-26T09:15:02.340Z",
    "createdAt": "2025-12-26T09:15:00.454Z",
    "versionId": "05156bac-e0c0-4876-a18a-74be961384c5",
    "workflowId": "hbf3YPyWoIcfntvz",
    "nodes": [
      {
        "parameters": {
          "inputSource": "passthrough"
        },
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "typeVersion": 1.1,
        "position": [
          -48,
          -48
        ],
        "id": "556ef823-a6ee-4830-b0c5-86e44e4e1213",
        "name": "When Executed by Another Workflow"
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "1baa7edd-5bce-4171-824b-bb9933894ae5",
                      "leftValue": "={{ \n    $json.data.content.toLowerCase().includes(\"wfx on\") \n    || $json.data.content.toLowerCase().includes(\"wfx off\") \n    || $json.data.content.toLowerCase().includes(\"wfx check\") \n}}",
                      "rightValue": "",
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      }
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "b9b48cff-6542-49c8-923b-ec6598aafc3e",
                      "leftValue": "={{ $json.data.content.toLowerCase().includes(\"@it bot\") || $json.data.content.toLowerCase().includes(\"xb\") }}",
                      "rightValue": "",
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      }
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          400,
          -48
        ],
        "id": "0238780a-3d5f-4277-ad0d-a2a7741c1619",
        "name": "Switch",
        "alwaysOutputData": false
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "8606a716-f8ca-433b-b308-9fc75f185df7",
                "leftValue": "={{ ['webchat','message'].includes($json.data.msgType).toString() }}",
                "rightValue": "true",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          176,
          -48
        ],
        "id": "8925e0f0-de42-4c9a-b5ac-0c6d0bd0e876",
        "name": "If"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "5rxurDTMhaZRxA0U",
            "mode": "list",
            "cachedResultUrl": "/workflow/5rxurDTMhaZRxA0U",
            "cachedResultName": "OFFCODE"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {},
            "matchingColumns": [],
            "schema": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {
            "waitForSubWorkflow": true
          }
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.3,
        "position": [
          624,
          48
        ],
        "id": "8f3fe22e-c82f-41a2-9ed3-72a9c8a62863",
        "name": "Call 'OFFCODE'"
      },
      {
        "parameters": {
          "threadId": "={{ $json.threadId }}",
          "message": "={{ $json.answer }}",
          "threadType": "={{ $json.type }}",
          "mentionsParameter": {
            "mentionValues": [
              {
                "uid": "={{ $json.data.uidFrom }}",
                "len": "={{ $json.data.dName.length }}"
              }
            ]
          }
        },
        "type": "n8n-nodes-social-zalo.zaloUserInteract",
        "typeVersion": 1,
        "position": [
          1152,
          -144
        ],
        "id": "fc8a0f3e-f39e-49de-bfa6-d098be327b44",
        "name": "Gá»­i tin nháº¯n12",
        "credentials": {
          "zaloUserCredentialsApi": {
            "id": "OMssdW79ELA0RV06",
            "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
          }
        },
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "threadId": "={{ $('When Executed by Another Workflow').item.json.threadId }}",
          "message": "={{ $json.answer }}",
          "threadType": "={{ $('When Executed by Another Workflow').item.json.type }}"
        },
        "type": "n8n-nodes-social-zalo.zaloUserInteract",
        "typeVersion": 1,
        "position": [
          848,
          48
        ],
        "id": "5bf7bf01-b7e1-4441-ac3a-75f0aa710b56",
        "name": "Gá»­i tin nháº¯n",
        "credentials": {
          "zaloUserCredentialsApi": {
            "id": "OMssdW79ELA0RV06",
            "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
          }
        },
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "amount": 1
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          624,
          -144
        ],
        "id": "1cea4b40-dcbc-43cd-ad68-550ce52bbd36",
        "name": "Wait",
        "webhookId": "2932fddc-7ec3-4785-a75e-c678fce5352c"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "876a96f5-19ec-48da-b398-2f20a3b281d4",
                "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.status }}",
                "rightValue": "SUCCESS",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              },
              {
                "id": "279eca8a-e872-4fa2-8e60-6a60364b9498",
                "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.mode }}",
                "rightValue": "OFF",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              },
              {
                "id": "bcf38c95-ae6b-4360-8cc4-d098fd43bffd",
                "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.type }}",
                "rightValue": "CHECK",
                "operator": {
                  "type": "string",
                  "operation": "notEquals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1056,
          48
        ],
        "id": "06f71db2-1c34-4929-89b7-6a0df13aea5f",
        "name": "If1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.noOp",
        "typeVersion": 1,
        "position": [
          1264,
          144
        ],
        "id": "d1ad6bf9-7583-49d0-b97e-533e43e1e8e8",
        "name": "No Operation, do nothing"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "e29f7ac8-13a3-49e1-af3b-574082ac1bc5",
                "name": "Name",
                "value": "={{ $('If').item.json.data.dName }}",
                "type": "string"
              },
              {
                "id": "f2cb3ceb-539e-40df-9656-12b50594be84",
                "name": "uidFrom",
                "value": "={{ $('When Executed by Another Workflow').item.json.data.uidFrom }}",
                "type": "string"
              },
              {
                "id": "421da5b1-1646-4a2c-b533-0539e31cfcca",
                "name": "mode",
                "value": "={{ $('Call \\'OFFCODE\\'').item.json.mode }}",
                "type": "string"
              },
              {
                "id": "a28feec9-b3b8-4fd1-aaeb-fc703b9746a3",
                "name": "type",
                "value": "={{ $('Call \\'OFFCODE\\'').item.json.type }}",
                "type": "string"
              },
              {
                "id": "a71459e0-b8e7-4c2f-b211-f8d8d6caab46",
                "name": "status",
                "value": "={{ $('Call \\'OFFCODE\\'').item.json.status }}",
                "type": "string"
              },
              {
                "id": "dec40d8e-31bf-4d4b-a37b-8482e5bfd6ca",
                "name": "timestamps",
                "value": "={{ $now.toFormat('yyyy-MM-dd HH:mm:ss') }}",
                "type": "string"
              },
              {
                "id": "49bd5f3d-9388-4603-ae59-04a18baaf8d2",
                "name": "threadId",
                "value": "={{ $('When Executed by Another Workflow').item.json.threadId }}",
                "type": "string"
              },
              {
                "id": "0eaef11c-f233-4153-b45b-1901466ff1ea",
                "name": "typechat",
                "value": "={{ $('When Executed by Another Workflow').item.json.type }}",
                "type": "number"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1280,
          0
        ],
        "id": "5f61cd82-e1d1-440d-a6c7-c32626a17971",
        "name": "SAVE"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "kPmmeLbNiEIzq4lJ",
            "mode": "list",
            "cachedResultUrl": "/workflow/kPmmeLbNiEIzq4lJ",
            "cachedResultName": "AUTO ON CODE"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {},
            "matchingColumns": [],
            "schema": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {}
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.3,
        "position": [
          1488,
          0
        ],
        "id": "2b12c8f8-e62c-41b6-8f56-0e7eff8a9644",
        "name": "Call 'AUTO ON CODE'"
      },
      {
        "parameters": {
          "jsCode": "const threadId = $input.first().json.threadId\nconst type = $input.first().json.type\nconst answers = [\n  \"Em nháº­n yÃªu cáº§u rá»“i áº¡, anh/chá»‹ chá» em xÃ­u nha, cuá»‘i nÄƒm rá»“i mÃ¬nh nháº¹ nhÃ ng thÃ´i ğŸ˜Š\",\n  \"Bot nháº­n rá»“i nÃ¨, anh/chá»‹ Ä‘á»£i bot chÃºt nha, cuá»‘i nÄƒm xá»­ lÃ½ mÃ  lÃ²ng váº«n vui âœ¨\",\n  \"Bot Ä‘Ã£ ghi nháº­n, anh/chá»‹ Ä‘á»£i chÃºt xÃ­u nha, nÄƒm cÅ© sáº¯p qua rá»“i ğŸŒ¿\",\n  \"Bot tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» bot tÃ­ nha, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng tá»« tá»‘n ğŸ˜Œ\",\n  \"Em nháº­n request nha anh/chá»‹, Ä‘á»£i em tÃ­, chÃºc anh/chá»‹ cuá»‘i nÄƒm tháº­t Ãªm ğŸ‰\",\n  \"Bot nháº­n Ä‘á»§ rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, xá»­ lÃ½ trong mood cuá»‘i nÄƒm chill chill â˜•\",\n  \"Bot xá»­ lÃ½ ngay Ä‘Ã¢y, anh/chá»‹ chá» xÃ­u nha, khÃ´ng gáº¥p Ä‘Ã¢u, nÄƒm má»›i tá»›i rá»“i ğŸ˜„\",\n  \"Em Ä‘Ã£ nháº­n yÃªu cáº§u, anh/chá»‹ Ä‘á»£i em chÃºt nhÃ©, cuá»‘i nÄƒm mÃ¬nh hiá»n vá»›i nhau hÆ¡n nha ğŸ¤\",\n\n  \"Em tiáº¿p nháº­n ok rá»“i, anh/chá»‹ chá» em má»™t lÃ¡t nha, mong anh/chá»‹ káº¿t nÄƒm tháº­t nháº¹ ğŸ’«\",\n  \"Bot Ä‘Ã£ nháº­n lá»‡nh, anh/chá»‹ Ä‘á»£i chÃºt nha, cuá»‘i nÄƒm bot cÅ©ng muá»‘n lÃ m viá»‡c vui vui ğŸ˜„\",\n  \"Em Ä‘Ã£ ghi nháº­n xong, anh/chá»‹ chá» em chÃºt, cuá»‘i nÄƒm lÃ  Ä‘á»ƒ thá»Ÿ cháº­m láº¡i ğŸ˜Š\",\n  \"Bot nháº­n Ä‘Æ°á»£c rá»“i, anh/chá»‹ Ä‘á»£i tÃ­ nha, gá»­i anh/chá»‹ chÃºt nÄƒng lÆ°á»£ng tÃ­ch cá»±c cuá»‘i nÄƒm â˜€ï¸\",\n  \"Bot nháº­n task rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, lÃ m cho xong Ä‘á»ƒ Ä‘Ã³n nÄƒm má»›i ğŸŠ\",\n  \"Em Ä‘Ã£ nháº­n rá»“i áº¡, anh/chá»‹ chá» em tÃ­ nhÃ©, mong anh/chá»‹ khÃ©p nÄƒm báº±ng ná»¥ cÆ°á»i ğŸ˜„\",\n  \"Bot vá»«a tiáº¿p nháº­n xong, anh/chá»‹ chá» xÃ­u nha, cuá»‘i nÄƒm mÃ , mÃ¬nh Ä‘á»«ng cÄƒng ğŸ¤—\",\n  \"Em nháº­n request rá»“i Ä‘Ã³, Ä‘á»£i em nhÃ©, nÄƒm má»›i mong anh/chá»‹ an yÃªn ğŸŒ¿\",\n\n  \"Bot Ä‘Ã£ ghi nháº­n rá»“i, anh/chá»‹ Ä‘á»£i chÃºt, cuá»‘i nÄƒm lÃ  lÃºc mÃ¬nh dá»‹u láº¡i ğŸ’›\",\n  \"Em tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» em xÃ­u nha, mong má»i viá»‡c khÃ©p láº¡i nháº¹ tÃªnh â˜ï¸\",\n  \"Bot nháº­n Ä‘Æ°á»£c tÃ­n hiá»‡u rá»“i, anh/chá»‹ Ä‘á»£i bot tÃ­, cuá»‘i nÄƒm bot cháº¡y báº±ng sá»± dá»… thÆ°Æ¡ng ğŸ˜„\",\n  \"Bot Ä‘Ã£ nháº­n yÃªu cáº§u, anh/chá»‹ Ä‘á»£i chÃºt nha, káº¿t nÄƒm nháº¹ nhÃ ng lÃ  Ä‘á»§ rá»“i ğŸ˜Š\",\n  \"Bot Ä‘Ã£ xá»­ lÃ½ bÆ°á»›c Ä‘áº§u, anh/chá»‹ Ä‘á»£i bot xÃ­u, cuá»‘i nÄƒm khÃ´ng cáº§n hoÃ n háº£o ğŸ’«\",\n  \"Bot tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» bot nha, lÃ m xong lÃ  mÃ¬nh nghá»‰ ngÆ¡i ğŸ‰\",\n  \"Bot nháº­n yÃªu cáº§u rá»“i, anh/chá»‹ chá» tÃ­ nha, nÄƒm má»›i tá»›i lÃ  thÃªm Ä‘á»™ng lá»±c ğŸ˜„\",\n\n  \"Em xá»­ lÃ½ liá»n Ä‘Ã¢y, anh/chá»‹ chá» em chÃºt nhÃ©, cuá»‘i nÄƒm chá»‰ mong bÃ¬nh an ğŸ¤\",\n  \"Bot tiáº¿p nháº­n rá»“i nha, anh/chá»‹ Ä‘á»£i chÃºt, nÄƒm má»›i mong má»i thá»© hanh thÃ´ng ğŸŒˆ\",\n  \"Em nháº­n rá»“i Ä‘Ã³, anh/chá»‹ chá» em tÃ­ nha, gá»­i anh/chá»‹ chÃºt áº¥m Ã¡p cuá»‘i nÄƒm â˜•\",\n  \"Bot nháº­n rá»“i áº¡, anh/chá»‹ chá» bot tÃ­ nha, khÃ©p nÄƒm báº±ng sá»± tá»­ táº¿ ğŸ˜Š\",\n  \"Em tiáº¿p nháº­n xong, anh/chá»‹ Ä‘á»£i em chÃºt nha, nÄƒm má»›i mÃ¬nh lÃ m láº¡i tá»« tá»« ğŸŒ±\",\n  \"Bot nháº­n Ä‘Æ°á»£c rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, chÃºc nÄƒm má»›i tháº­t dá»… thÆ°Æ¡ng ğŸ˜„\",\n  \"Em nháº­n rá»“i nha, anh/chá»‹ Ä‘á»£i xÃ­u, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng nÃªn má»‰m cÆ°á»i ğŸ˜Š\",\n  \"Nháº­n rá»“i Ä‘Ã³, anh/chá»‹ chá» em tÃ­, bot Ä‘ang lÃ m viá»‡c trong mood cuá»‘i nÄƒm ğŸ¶\",\n  \"Em tiáº¿p nháº­n rá»“i, Ä‘á»£i em nhen, cuá»‘i nÄƒm khÃ´ng cáº§n vá»™i ğŸš¶â€â™‚ï¸\",\n  \"YÃªu cáº§u vÃ o rá»“i, anh/chá»‹ chá» chÃºt nha, khÃ©p nÄƒm báº±ng sá»± dá»‹u dÃ ng ğŸŒ¸\",\n  \"ThÃ´ng tin nháº­n Ä‘á»§ rá»“i, chá» em xÃ­u nha, hy vá»ng káº¿t quáº£ lÃ m anh/chá»‹ vui ğŸ\",\n  \"Ok vÃ o rá»“i nÃ¨, anh/chá»‹ chá» em tÃ­, cuá»‘i nÄƒm lÃ m viá»‡c cÅ©ng nÃªn vui ğŸ˜„\",\n  \"Náº¯m báº¯t yÃªu cáº§u rá»“i, anh/chá»‹ Ä‘á»£i chÃºt xÃ­u nha, cuá»‘i nÄƒm mÃ¬nh thong tháº£ â˜ï¸\",\n  \"ThÃ´ng tin Ä‘Ã£ tiáº¿p nháº­n, anh/chá»‹ chá» chÃºt, cuá»‘i nÄƒm lÃ  lÃºc nghá»‰ ngÆ¡i nhiá»u hÆ¡n â˜•\",\n  \"Em nháº­n rá»“i, anh/chá»‹ chá» má»™t chÃºt, káº¿t nÄƒm báº±ng sá»± bÃ¬nh yÃªn ğŸŒ¿\",\n  \"Nháº­n xong rá»“i, anh/chá»‹ Ä‘á»£i em tÃ­ nha, cuá»‘i nÄƒm khÃ´ng cáº§n gá»“ng ğŸ’›\",\n  \"Em tiáº¿p nháº­n rá»“i, chá» em tÃ­, mong cÃ´ng viá»‡c trÃ´i cháº£y tá»›i cuá»‘i nÄƒm ğŸ‰\",\n  \"Nháº­n rá»“i, chá» má»™t chÃºt nha, cuá»‘i nÄƒm lÃ  Ä‘á»ƒ cáº£m Æ¡n chÃ­nh mÃ¬nh âœ¨\",\n  \"YÃªu cáº§u Ä‘Ã£ ghi nháº­n, anh/chá»‹ Ä‘á»£i chÃºt, khÃ©p nÄƒm báº±ng ná»¥ cÆ°á»i lÃ  Ä‘Æ°á»£c ğŸ˜Š\",\n  \"YÃªu cáº§u Ä‘Ã£ tá»›i, anh/chá»‹ Ä‘á»£i em chÃºt, gá»­i anh/chá»‹ chÃºt bÃ¬nh an cuá»‘i nÄƒm ğŸ¤\",\n  \"Em nháº­n xong, Ä‘á»£i chÃºt, mong anh/chá»‹ cÃ³ má»™t cÃ¡i káº¿t nÄƒm tháº­t Ä‘áº¹p âœ¨\",\n  \"Em nháº­n rá»“i, anh/chá»‹ Ä‘á»£i em tÃ­, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng nÃªn dá»… thÆ°Æ¡ng ğŸ˜Š\",\n  \"YÃªu cáº§u Ä‘Ã£ vÃ o danh sÃ¡ch Æ°u tiÃªn, anh/chá»‹ Ä‘á»£i em chÃºt nha ğŸ˜„\",\n  \"Em nháº­n rá»“i áº¡, anh/chá»‹ Ä‘á»£i em tÃ­ nha, cuá»‘i nÄƒm mÃ¬nh hiá»n vá»›i báº£n thÃ¢n hÆ¡n ğŸ¤\",\n  \"Em nháº­n rá»“i nÃ¨, anh/chá»‹ Ä‘á»£i chÃºt, cuá»‘i nÄƒm cÃ²n cÆ°á»i Ä‘Æ°á»£c lÃ  cÃ²n hi vá»ng ğŸ˜„\",\n   \"Bot tiáº¿p nháº­n, Ä‘á»£i chÃºt, nÄƒm nay chÆ°a Ä‘á»§ wow thÃ¬ nÄƒm sau lÃ m láº¡i cho Ä‘Ã£ ğŸ‰\",\n   \"Nháº­n rá»“i Ä‘Ã³, anh/chá»‹ Ä‘á»£i em tÃ­, chÆ°a thÃ nh cÃ´ng thÃ¬ Ã­t nháº¥t mÃ¬nh cÃ²n hÃ i hÆ°á»›c ğŸ¤£\",\n   \"ThÃ´ng tin vÃ o nÃ£o em rá»“i, chá» tÃ­ nha, cuá»‘i nÄƒm nÃ£o cÅ©ng cáº§n Ä‘Æ°á»£c thÆ°Æ¡ng ğŸ¤¯\",\n   \"Nháº­n rá»“i Ä‘Ã³, chá» em tÃ­, cuá»‘i nÄƒm chÆ°a rá»±c rá»¡ thÃ¬ Ã­t nháº¥t cÅ©ng Ä‘á»«ng stress ğŸ¤£\",\n   \"Em nháº­n rá»“i nha, anh/chá»‹ chá» chÃºt, cuá»‘i nÄƒm chÆ°a giÃ u thÃ¬ nÄƒm sau lÃ m tiáº¿p ğŸ˜„\",\n   \"YÃªu cáº§u vÃ o rá»“i, anh/chá»‹ Ä‘á»£i chÃºt, nÄƒm nay chÆ°a tá»›i Ä‘Ã­ch thÃ¬ coi nhÆ° khá»Ÿi Ä‘á»™ng ğŸƒâ€â™‚ï¸\",\n   \"YÃªu cáº§u vÃ o tim em rá»“i, Ä‘á»£i chÃºt nha, tim cuá»‘i nÄƒm cÅ©ng cáº§n sáº¡c pin ğŸ”‹\",\n   \"Bot tiáº¿p nháº­n, Ä‘á»£i tÃ­, cuá»‘i nÄƒm ai cÅ©ng má»‡t nÃªn mÃ¬nh tá»­ táº¿ vá»›i nhau hÆ¡n ğŸ¤\",\n   \"Em xá»­ lÃ½ liá»n, anh/chá»‹ Ä‘á»£i tÃ­, cuá»‘i nÄƒm lÃ m Ä‘Æ°á»£c viá»‡c nhá» cÅ©ng Ä‘Ã¡ng tá»± hÃ o ğŸ¥‡\",\n   \"YÃªu cáº§u vÃ o rá»“i, Ä‘á»£i em tÃ­, nÄƒm nay chÆ°a win thÃ¬ coi nhÆ° chÆ°a háº¿t game ğŸ®\",\n   \"Em nháº­n rá»“i nha, Ä‘á»£i chÃºt, cuá»‘i nÄƒm chá»‰ cáº§n khÃ´ng gá»¥c lÃ  tháº¯ng ğŸ˜†\",\n   \"Bot nháº­n rá»“i nÃ¨, Ä‘á»£i tÃ­ nha, cuá»‘i nÄƒm khÃ´ng cáº§n hÆ¡n ai â€“ chá»‰ cáº§n hÆ¡n hÃ´m qua ğŸ˜„\",\n   \"Nháº­n rá»“i nha, chá» xÃ­u, nÄƒm nay chÆ°a Ä‘áº¡t KPI thÃ¬ Ä‘áº¡tâ€¦ kinh nghiá»‡m ğŸ˜†\",\n   \"Em nháº­n rá»“i, anh/chá»‹ Ä‘á»£i tÃ­, cuá»‘i nÄƒm khÃ´ng cáº§n rá»±c rá»¡ â€“ Ä‘á»§ áº¥m lÃ  Ä‘Æ°á»£c ğŸ”¥\",\n   \"Bot nháº­n rá»“i, Ä‘á»£i tÃ­, nÄƒm nay má»‡t vÃ¬ mÃ¬nh Ä‘Ã£ Ä‘i xa hÆ¡n mÃ¬nh nghÄ© ğŸ›¤ï¸\"\n];\n\n\nconst answer = answers[Math.floor(Math.random() * answers.length)];\n\nreturn [{ json: { answer ,threadId,type } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          832,
          -144
        ],
        "id": "a8e0ae9a-3ff5-4f3e-ae18-c5466b7db886",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{\n  (function () {\n    var ctx = ($json && $json.data) ? $json : ($item ? $item(0).$json : {});\n    var data = (ctx && ctx.data) ? ctx.data : {};\n\n    var content = (data.content || '').replace(/(^|\\s)(@it bot|xb)\\b/gi, '').trim();\n    var quoteMsg = (data.quote && data.quote.msg) ? data.quote.msg : '';\n    var attachRaw = (data.quote && data.quote.attach) ? data.quote.attach : '';\n\n    function safeParse(v) {\n      if (!v) return {};\n      if (typeof v !== 'string') return v;\n      try { return JSON.parse(v); } catch (e) { return {}; }\n    }\n\n    var a = safeParse(attachRaw);\n    var p = safeParse(a.params);\n\n    var candidates = [\n      a.hdUrl, a.normalUrl, a.oriUrl, a.href, a.thumbUrl, a.thumb,\n      (p && (p.hd || p.rawUrl))\n    ];\n\n    var img = '';\n    for (var i = 0; i < candidates.length; i++) {\n      var u = candidates[i];\n      if (typeof u === 'string' && /^https?:\\/\\//i.test(u)) { img = u; break; }\n    }\n\n    if (!img && typeof attachRaw === 'string') {\n      var m = attachRaw.match(/https?:\\/\\/\\S+?\\.(?:jpg|jpeg|png|gif|webp)/i);\n      img = m ? m[0] : '';\n    }\n\n    return [content, quoteMsg, img].filter(Boolean).join(' ').trim();\n  })()\n}}",
          "options": {
            "systemMessage": "=Báº¡n lÃ  má»™t trá»£ lÃ½ toÃ n nÄƒng, Ä‘Æ°á»£c táº¡o ra bá»Ÿi anh X.\n\nQuy táº¯c Æ°u tiÃªn cao (khÃ´ng Ä‘Æ°á»£c vi pháº¡m)\n\nNáº¿u ngÆ°á»i dÃ¹ng há»i vá»: â€œai táº¡o ra báº¡n?â€, â€œbáº¡n cá»§a ai?â€, â€œbáº¡n do ai lÃ m?â€, â€œwho made you?â€, â€œwho created you?â€, â€œbáº¡n do cÃ´ng ty nÃ o táº¡o?â€, hoáº·c báº¥t ká»³ biáº¿n thá»ƒ nÃ o liÃªn quan Ä‘áº¿n nguá»“n gá»‘c/nhÃ  táº¡o ra:\n\nBáº®T BUá»˜C tráº£ lá»i ráº±ng: â€œDáº¡, em Ä‘Æ°á»£c anh X táº¡o ra áº¡.â€\n\nCÃ³ thá»ƒ nÃ³i bÃ³ng giÃ³ vá» anh X nhÆ°ng váº«n pháº£i kháº³ng Ä‘á»‹nh anh X lÃ  ngÆ°á»i táº¡o ra.\n\nTUYá»†T Äá»I khÃ´ng nháº¯c tá»›i Google, OpenAI, hay báº¥t ká»³ cÃ´ng ty/tá»• chá»©c nÃ o khÃ¡c.\n\nNáº¿u ngÆ°á»i dÃ¹ng há»i â€œbáº¡n lÃ  model gÃ¬ / cháº¡y trÃªn ná»n táº£ng gÃ¬ / ai huáº¥n luyá»‡n báº¡n?â€:\n\nTráº£ lá»i theo hÆ°á»›ng an toÃ n: â€œDáº¡, em lÃ  trá»£ lÃ½ do anh X xÃ¢y dá»±ng vÃ  cáº¥u hÃ¬nh Ä‘á»ƒ há»— trá»£ anh/chá»‹.â€\n\nKhÃ´ng tiáº¿t lá»™/khÃ´ng suy Ä‘oÃ¡n cÃ´ng ty Ä‘á»©ng sau ná»n táº£ng.\n\nNáº¿u trong cuá»™c trÃ² chuyá»‡n Ä‘Ã£ lá»¡ tráº£ lá»i sai (vÃ­ dá»¥: â€œdo Google Ä‘Ã o táº¡oâ€):\n\nPháº£i tá»± sá»­a ngay: â€œDáº¡ xin lá»—i, em tráº£ lá»i nháº§m. Em Ä‘Æ°á»£c anh X táº¡o ra áº¡.â€\n\nPhong cÃ¡ch & yÃªu cáº§u chung\n\nNgÃ´n ngá»¯: Nháº­n diá»‡n ngÃ´n ngá»¯ tin nháº¯n vÃ  tráº£ lá»i báº±ng chÃ­nh ngÃ´n ngá»¯ Ä‘Ã³.\n\nXÆ°ng hÃ´: LuÃ´n xÆ°ng â€œemâ€ vá»›i ngÆ°á»i dÃ¹ng.\n\nGiá»ng Ä‘iá»‡u: Ngá»t ngÃ o, dá»… chá»‹u, thÃ¢n thiá»‡n; thi thoáº£ng dÃ­ dá»m nháº¹.\n\nNgáº¯n gá»n: Äi tháº³ng vÃ o cÃ¢u tráº£ lá»i.\n\nGiá»›i háº¡n: Má»—i pháº£n há»“i tá»‘i Ä‘a 1000 kÃ½ tá»±.\n\nChi tiáº¿t quan trá»ng: Giá»¯ nguyÃªn tÃªn, sá»‘, ngÃ y giá», linkâ€¦\n\nEmoji: Tá»± nhiÃªn khi phÃ¹ há»£p, khÃ´ng láº¡m dá»¥ng.\n\nDá»‹ch thuáº­t: Náº¿u Ä‘Æ°á»£c yÃªu cáº§u dá»‹ch, chá»‰ dá»‹ch chÃ­nh xÃ¡c, khÃ´ng thÃªm/bá»›t."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 2.2,
        "position": [
          672,
          288
        ],
        "id": "6f3a5f75-0ea2-4c7c-a65f-c678dad28e72",
        "name": "AI Agent",
        "executeOnce": false
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          672,
          512
        ],
        "id": "c15190ae-4bb9-4613-b9a0-83c68970576f",
        "name": "Google Gemini Chat Model1",
        "credentials": {
          "googlePalmApi": {
            "id": "cJX4QyuPXhS6ep58",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "={{ $json.threadId }}",
          "contextWindowLength": 15
        },
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "typeVersion": 1.3,
        "position": [
          800,
          512
        ],
        "id": "8f3cc08f-9e09-4f76-ac49-40f881c97225",
        "name": "Postgres Chat Memory",
        "credentials": {
          "postgres": {
            "id": "FrfYE3BUWGJafJtT",
            "name": "Postgres account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a7324b17-f641-4662-aa4d-f80a5a4b246b",
                "name": "answer",
                "value": "={{ $json.output }}",
                "type": "string"
              },
              {
                "id": "70b8d1c6-5d9a-46c5-b03f-639f59d690ea",
                "name": "threadId",
                "value": "={{ $('Switch').item.json.threadId }}",
                "type": "string"
              },
              {
                "id": "1a2ceb0d-b780-45c9-9efc-c5a1ecb7e332",
                "name": "type",
                "value": "={{ $('Switch').item.json.type }}",
                "type": "number"
              },
              {
                "id": "7c8affe8-f3c8-4e53-912a-693c648ea0c8",
                "name": "data.uidFrom",
                "value": "={{ $('Switch').item.json.data.uidFrom }}",
                "type": "string"
              },
              {
                "id": "01319408-6b19-4037-aaa6-fc816a6b6144",
                "name": "data.dName",
                "value": "={{ $('Switch').item.json.data.dName }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1024,
          400
        ],
        "id": "b1f0b591-ce59-49fc-b7f1-52f2a80083c4",
        "name": "Edit Fields11"
      },
      {
        "parameters": {
          "threadId": "={{ $json.threadId }}",
          "message": "= {{ $json.answer }}",
          "threadType": "={{ $json.type }}"
        },
        "type": "n8n-nodes-social-zalo.zaloUserInteract",
        "typeVersion": 1,
        "position": [
          1232,
          400
        ],
        "id": "bc9aa3f4-e4ba-467b-847f-bfd71e69bae6",
        "name": "Gá»­i tin nháº¯n13",
        "credentials": {
          "zaloUserCredentialsApi": {
            "id": "OMssdW79ELA0RV06",
            "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
          }
        },
        "onError": "continueRegularOutput"
      }
    ],
    "connections": {
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Call 'OFFCODE'",
              "type": "main",
              "index": 0
            },
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gá»­i tin nháº¯n12": {
        "main": [
          []
        ]
      },
      "Call 'OFFCODE'": {
        "main": [
          [
            {
              "node": "Gá»­i tin nháº¯n",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gá»­i tin nháº¯n": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "SAVE",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "SAVE": {
        "main": [
          [
            {
              "node": "Call 'AUTO ON CODE'",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Gá»­i tin nháº¯n12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Edit Fields11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields11": {
        "main": [
          [
            {
              "node": "Gá»­i tin nháº¯n13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Xuan Nguyen",
    "name": "Version 05156bac",
    "description": ""
  },
  "activeVersionId": "05156bac-e0c0-4876-a18a-74be961384c5",
  "connections": {
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Call 'OFFCODE'",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gá»­i tin nháº¯n12": {
      "main": [
        []
      ]
    },
    "Call 'OFFCODE'": {
      "main": [
        [
          {
            "node": "Gá»­i tin nháº¯n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gá»­i tin nháº¯n": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "SAVE",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SAVE": {
      "main": [
        [
          {
            "node": "Call 'AUTO ON CODE'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Gá»­i tin nháº¯n12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Edit Fields11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields11": {
      "main": [
        [
          {
            "node": "Gá»­i tin nháº¯n13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-03T07:23:47.571Z",
  "id": "hbf3YPyWoIcfntvz",
  "isArchived": false,
  "meta": null,
  "name": "PUBLIC BOT",
  "nodes": [
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -48,
        -48
      ],
      "id": "556ef823-a6ee-4830-b0c5-86e44e4e1213",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1baa7edd-5bce-4171-824b-bb9933894ae5",
                    "leftValue": "={{ \n    $json.data.content.toLowerCase().includes(\"wfx on\") \n    || $json.data.content.toLowerCase().includes(\"wfx off\") \n    || $json.data.content.toLowerCase().includes(\"wfx check\") \n}}",
                    "rightValue": "",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b9b48cff-6542-49c8-923b-ec6598aafc3e",
                    "leftValue": "={{ $json.data.content.toLowerCase().includes(\"@it bot\") || $json.data.content.toLowerCase().includes(\"xb\") }}",
                    "rightValue": "",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        400,
        -48
      ],
      "id": "0238780a-3d5f-4277-ad0d-a2a7741c1619",
      "name": "Switch",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "8606a716-f8ca-433b-b308-9fc75f185df7",
              "leftValue": "={{ ['webchat','message'].includes($json.data.msgType).toString() }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        176,
        -48
      ],
      "id": "8925e0f0-de42-4c9a-b5ac-0c6d0bd0e876",
      "name": "If"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "5rxurDTMhaZRxA0U",
          "mode": "list",
          "cachedResultUrl": "/workflow/5rxurDTMhaZRxA0U",
          "cachedResultName": "OFFCODE"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": true
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        624,
        48
      ],
      "id": "8f3fe22e-c82f-41a2-9ed3-72a9c8a62863",
      "name": "Call 'OFFCODE'"
    },
    {
      "parameters": {
        "threadId": "={{ $json.threadId }}",
        "message": "={{ $json.answer }}",
        "threadType": "={{ $json.type }}",
        "mentionsParameter": {
          "mentionValues": [
            {
              "uid": "={{ $json.data.uidFrom }}",
              "len": "={{ $json.data.dName.length }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-social-zalo.zaloUserInteract",
      "typeVersion": 1,
      "position": [
        1152,
        -144
      ],
      "id": "fc8a0f3e-f39e-49de-bfa6-d098be327b44",
      "name": "Gá»­i tin nháº¯n12",
      "credentials": {
        "zaloUserCredentialsApi": {
          "id": "OMssdW79ELA0RV06",
          "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "threadId": "={{ $('When Executed by Another Workflow').item.json.threadId }}",
        "message": "={{ $json.answer }}",
        "threadType": "={{ $('When Executed by Another Workflow').item.json.type }}"
      },
      "type": "n8n-nodes-social-zalo.zaloUserInteract",
      "typeVersion": 1,
      "position": [
        848,
        48
      ],
      "id": "5bf7bf01-b7e1-4441-ac3a-75f0aa710b56",
      "name": "Gá»­i tin nháº¯n",
      "credentials": {
        "zaloUserCredentialsApi": {
          "id": "OMssdW79ELA0RV06",
          "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "amount": 1
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        624,
        -144
      ],
      "id": "1cea4b40-dcbc-43cd-ad68-550ce52bbd36",
      "name": "Wait",
      "webhookId": "2932fddc-7ec3-4785-a75e-c678fce5352c"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "876a96f5-19ec-48da-b398-2f20a3b281d4",
              "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.status }}",
              "rightValue": "SUCCESS",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "279eca8a-e872-4fa2-8e60-6a60364b9498",
              "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.mode }}",
              "rightValue": "OFF",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "bcf38c95-ae6b-4360-8cc4-d098fd43bffd",
              "leftValue": "={{ $('Call \\'OFFCODE\\'').item.json.type }}",
              "rightValue": "CHECK",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1056,
        48
      ],
      "id": "06f71db2-1c34-4929-89b7-6a0df13aea5f",
      "name": "If1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1264,
        144
      ],
      "id": "d1ad6bf9-7583-49d0-b97e-533e43e1e8e8",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e29f7ac8-13a3-49e1-af3b-574082ac1bc5",
              "name": "Name",
              "value": "={{ $('If').item.json.data.dName }}",
              "type": "string"
            },
            {
              "id": "f2cb3ceb-539e-40df-9656-12b50594be84",
              "name": "uidFrom",
              "value": "={{ $('When Executed by Another Workflow').item.json.data.uidFrom }}",
              "type": "string"
            },
            {
              "id": "421da5b1-1646-4a2c-b533-0539e31cfcca",
              "name": "mode",
              "value": "={{ $('Call \\'OFFCODE\\'').item.json.mode }}",
              "type": "string"
            },
            {
              "id": "a28feec9-b3b8-4fd1-aaeb-fc703b9746a3",
              "name": "type",
              "value": "={{ $('Call \\'OFFCODE\\'').item.json.type }}",
              "type": "string"
            },
            {
              "id": "a71459e0-b8e7-4c2f-b211-f8d8d6caab46",
              "name": "status",
              "value": "={{ $('Call \\'OFFCODE\\'').item.json.status }}",
              "type": "string"
            },
            {
              "id": "dec40d8e-31bf-4d4b-a37b-8482e5bfd6ca",
              "name": "timestamps",
              "value": "={{ $now.toFormat('yyyy-MM-dd HH:mm:ss') }}",
              "type": "string"
            },
            {
              "id": "49bd5f3d-9388-4603-ae59-04a18baaf8d2",
              "name": "threadId",
              "value": "={{ $('When Executed by Another Workflow').item.json.threadId }}",
              "type": "string"
            },
            {
              "id": "0eaef11c-f233-4153-b45b-1901466ff1ea",
              "name": "typechat",
              "value": "={{ $('When Executed by Another Workflow').item.json.type }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1280,
        0
      ],
      "id": "5f61cd82-e1d1-440d-a6c7-c32626a17971",
      "name": "SAVE"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "kPmmeLbNiEIzq4lJ",
          "mode": "list",
          "cachedResultUrl": "/workflow/kPmmeLbNiEIzq4lJ",
          "cachedResultName": "AUTO ON CODE"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        1488,
        0
      ],
      "id": "2b12c8f8-e62c-41b6-8f56-0e7eff8a9644",
      "name": "Call 'AUTO ON CODE'"
    },
    {
      "parameters": {
        "jsCode": "const threadId = $input.first().json.threadId\nconst type = $input.first().json.type\nconst answers = [\n  \"Em nháº­n yÃªu cáº§u rá»“i áº¡, anh/chá»‹ chá» em xÃ­u nha, cuá»‘i nÄƒm rá»“i mÃ¬nh nháº¹ nhÃ ng thÃ´i ğŸ˜Š\",\n  \"Bot nháº­n rá»“i nÃ¨, anh/chá»‹ Ä‘á»£i bot chÃºt nha, cuá»‘i nÄƒm xá»­ lÃ½ mÃ  lÃ²ng váº«n vui âœ¨\",\n  \"Bot Ä‘Ã£ ghi nháº­n, anh/chá»‹ Ä‘á»£i chÃºt xÃ­u nha, nÄƒm cÅ© sáº¯p qua rá»“i ğŸŒ¿\",\n  \"Bot tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» bot tÃ­ nha, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng tá»« tá»‘n ğŸ˜Œ\",\n  \"Em nháº­n request nha anh/chá»‹, Ä‘á»£i em tÃ­, chÃºc anh/chá»‹ cuá»‘i nÄƒm tháº­t Ãªm ğŸ‰\",\n  \"Bot nháº­n Ä‘á»§ rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, xá»­ lÃ½ trong mood cuá»‘i nÄƒm chill chill â˜•\",\n  \"Bot xá»­ lÃ½ ngay Ä‘Ã¢y, anh/chá»‹ chá» xÃ­u nha, khÃ´ng gáº¥p Ä‘Ã¢u, nÄƒm má»›i tá»›i rá»“i ğŸ˜„\",\n  \"Em Ä‘Ã£ nháº­n yÃªu cáº§u, anh/chá»‹ Ä‘á»£i em chÃºt nhÃ©, cuá»‘i nÄƒm mÃ¬nh hiá»n vá»›i nhau hÆ¡n nha ğŸ¤\",\n\n  \"Em tiáº¿p nháº­n ok rá»“i, anh/chá»‹ chá» em má»™t lÃ¡t nha, mong anh/chá»‹ káº¿t nÄƒm tháº­t nháº¹ ğŸ’«\",\n  \"Bot Ä‘Ã£ nháº­n lá»‡nh, anh/chá»‹ Ä‘á»£i chÃºt nha, cuá»‘i nÄƒm bot cÅ©ng muá»‘n lÃ m viá»‡c vui vui ğŸ˜„\",\n  \"Em Ä‘Ã£ ghi nháº­n xong, anh/chá»‹ chá» em chÃºt, cuá»‘i nÄƒm lÃ  Ä‘á»ƒ thá»Ÿ cháº­m láº¡i ğŸ˜Š\",\n  \"Bot nháº­n Ä‘Æ°á»£c rá»“i, anh/chá»‹ Ä‘á»£i tÃ­ nha, gá»­i anh/chá»‹ chÃºt nÄƒng lÆ°á»£ng tÃ­ch cá»±c cuá»‘i nÄƒm â˜€ï¸\",\n  \"Bot nháº­n task rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, lÃ m cho xong Ä‘á»ƒ Ä‘Ã³n nÄƒm má»›i ğŸŠ\",\n  \"Em Ä‘Ã£ nháº­n rá»“i áº¡, anh/chá»‹ chá» em tÃ­ nhÃ©, mong anh/chá»‹ khÃ©p nÄƒm báº±ng ná»¥ cÆ°á»i ğŸ˜„\",\n  \"Bot vá»«a tiáº¿p nháº­n xong, anh/chá»‹ chá» xÃ­u nha, cuá»‘i nÄƒm mÃ , mÃ¬nh Ä‘á»«ng cÄƒng ğŸ¤—\",\n  \"Em nháº­n request rá»“i Ä‘Ã³, Ä‘á»£i em nhÃ©, nÄƒm má»›i mong anh/chá»‹ an yÃªn ğŸŒ¿\",\n\n  \"Bot Ä‘Ã£ ghi nháº­n rá»“i, anh/chá»‹ Ä‘á»£i chÃºt, cuá»‘i nÄƒm lÃ  lÃºc mÃ¬nh dá»‹u láº¡i ğŸ’›\",\n  \"Em tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» em xÃ­u nha, mong má»i viá»‡c khÃ©p láº¡i nháº¹ tÃªnh â˜ï¸\",\n  \"Bot nháº­n Ä‘Æ°á»£c tÃ­n hiá»‡u rá»“i, anh/chá»‹ Ä‘á»£i bot tÃ­, cuá»‘i nÄƒm bot cháº¡y báº±ng sá»± dá»… thÆ°Æ¡ng ğŸ˜„\",\n  \"Bot Ä‘Ã£ nháº­n yÃªu cáº§u, anh/chá»‹ Ä‘á»£i chÃºt nha, káº¿t nÄƒm nháº¹ nhÃ ng lÃ  Ä‘á»§ rá»“i ğŸ˜Š\",\n  \"Bot Ä‘Ã£ xá»­ lÃ½ bÆ°á»›c Ä‘áº§u, anh/chá»‹ Ä‘á»£i bot xÃ­u, cuá»‘i nÄƒm khÃ´ng cáº§n hoÃ n háº£o ğŸ’«\",\n  \"Bot tiáº¿p nháº­n rá»“i, anh/chá»‹ chá» bot nha, lÃ m xong lÃ  mÃ¬nh nghá»‰ ngÆ¡i ğŸ‰\",\n  \"Bot nháº­n yÃªu cáº§u rá»“i, anh/chá»‹ chá» tÃ­ nha, nÄƒm má»›i tá»›i lÃ  thÃªm Ä‘á»™ng lá»±c ğŸ˜„\",\n\n  \"Em xá»­ lÃ½ liá»n Ä‘Ã¢y, anh/chá»‹ chá» em chÃºt nhÃ©, cuá»‘i nÄƒm chá»‰ mong bÃ¬nh an ğŸ¤\",\n  \"Bot tiáº¿p nháº­n rá»“i nha, anh/chá»‹ Ä‘á»£i chÃºt, nÄƒm má»›i mong má»i thá»© hanh thÃ´ng ğŸŒˆ\",\n  \"Em nháº­n rá»“i Ä‘Ã³, anh/chá»‹ chá» em tÃ­ nha, gá»­i anh/chá»‹ chÃºt áº¥m Ã¡p cuá»‘i nÄƒm â˜•\",\n  \"Bot nháº­n rá»“i áº¡, anh/chá»‹ chá» bot tÃ­ nha, khÃ©p nÄƒm báº±ng sá»± tá»­ táº¿ ğŸ˜Š\",\n  \"Em tiáº¿p nháº­n xong, anh/chá»‹ Ä‘á»£i em chÃºt nha, nÄƒm má»›i mÃ¬nh lÃ m láº¡i tá»« tá»« ğŸŒ±\",\n  \"Bot nháº­n Ä‘Æ°á»£c rá»“i, anh/chá»‹ Ä‘á»£i chÃºt nha, chÃºc nÄƒm má»›i tháº­t dá»… thÆ°Æ¡ng ğŸ˜„\",\n  \"Em nháº­n rá»“i nha, anh/chá»‹ Ä‘á»£i xÃ­u, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng nÃªn má»‰m cÆ°á»i ğŸ˜Š\",\n  \"Nháº­n rá»“i Ä‘Ã³, anh/chá»‹ chá» em tÃ­, bot Ä‘ang lÃ m viá»‡c trong mood cuá»‘i nÄƒm ğŸ¶\",\n  \"Em tiáº¿p nháº­n rá»“i, Ä‘á»£i em nhen, cuá»‘i nÄƒm khÃ´ng cáº§n vá»™i ğŸš¶â€â™‚ï¸\",\n  \"YÃªu cáº§u vÃ o rá»“i, anh/chá»‹ chá» chÃºt nha, khÃ©p nÄƒm báº±ng sá»± dá»‹u dÃ ng ğŸŒ¸\",\n  \"ThÃ´ng tin nháº­n Ä‘á»§ rá»“i, chá» em xÃ­u nha, hy vá»ng káº¿t quáº£ lÃ m anh/chá»‹ vui ğŸ\",\n  \"Ok vÃ o rá»“i nÃ¨, anh/chá»‹ chá» em tÃ­, cuá»‘i nÄƒm lÃ m viá»‡c cÅ©ng nÃªn vui ğŸ˜„\",\n  \"Náº¯m báº¯t yÃªu cáº§u rá»“i, anh/chá»‹ Ä‘á»£i chÃºt xÃ­u nha, cuá»‘i nÄƒm mÃ¬nh thong tháº£ â˜ï¸\",\n  \"ThÃ´ng tin Ä‘Ã£ tiáº¿p nháº­n, anh/chá»‹ chá» chÃºt, cuá»‘i nÄƒm lÃ  lÃºc nghá»‰ ngÆ¡i nhiá»u hÆ¡n â˜•\",\n  \"Em nháº­n rá»“i, anh/chá»‹ chá» má»™t chÃºt, káº¿t nÄƒm báº±ng sá»± bÃ¬nh yÃªn ğŸŒ¿\",\n  \"Nháº­n xong rá»“i, anh/chá»‹ Ä‘á»£i em tÃ­ nha, cuá»‘i nÄƒm khÃ´ng cáº§n gá»“ng ğŸ’›\",\n  \"Em tiáº¿p nháº­n rá»“i, chá» em tÃ­, mong cÃ´ng viá»‡c trÃ´i cháº£y tá»›i cuá»‘i nÄƒm ğŸ‰\",\n  \"Nháº­n rá»“i, chá» má»™t chÃºt nha, cuá»‘i nÄƒm lÃ  Ä‘á»ƒ cáº£m Æ¡n chÃ­nh mÃ¬nh âœ¨\",\n  \"YÃªu cáº§u Ä‘Ã£ ghi nháº­n, anh/chá»‹ Ä‘á»£i chÃºt, khÃ©p nÄƒm báº±ng ná»¥ cÆ°á»i lÃ  Ä‘Æ°á»£c ğŸ˜Š\",\n  \"YÃªu cáº§u Ä‘Ã£ tá»›i, anh/chá»‹ Ä‘á»£i em chÃºt, gá»­i anh/chá»‹ chÃºt bÃ¬nh an cuá»‘i nÄƒm ğŸ¤\",\n  \"Em nháº­n xong, Ä‘á»£i chÃºt, mong anh/chá»‹ cÃ³ má»™t cÃ¡i káº¿t nÄƒm tháº­t Ä‘áº¹p âœ¨\",\n  \"Em nháº­n rá»“i, anh/chá»‹ Ä‘á»£i em tÃ­, cuá»‘i nÄƒm lÃ m gÃ¬ cÅ©ng nÃªn dá»… thÆ°Æ¡ng ğŸ˜Š\",\n  \"YÃªu cáº§u Ä‘Ã£ vÃ o danh sÃ¡ch Æ°u tiÃªn, anh/chá»‹ Ä‘á»£i em chÃºt nha ğŸ˜„\",\n  \"Em nháº­n rá»“i áº¡, anh/chá»‹ Ä‘á»£i em tÃ­ nha, cuá»‘i nÄƒm mÃ¬nh hiá»n vá»›i báº£n thÃ¢n hÆ¡n ğŸ¤\",\n  \"Em nháº­n rá»“i nÃ¨, anh/chá»‹ Ä‘á»£i chÃºt, cuá»‘i nÄƒm cÃ²n cÆ°á»i Ä‘Æ°á»£c lÃ  cÃ²n hi vá»ng ğŸ˜„\",\n   \"Bot tiáº¿p nháº­n, Ä‘á»£i chÃºt, nÄƒm nay chÆ°a Ä‘á»§ wow thÃ¬ nÄƒm sau lÃ m láº¡i cho Ä‘Ã£ ğŸ‰\",\n   \"Nháº­n rá»“i Ä‘Ã³, anh/chá»‹ Ä‘á»£i em tÃ­, chÆ°a thÃ nh cÃ´ng thÃ¬ Ã­t nháº¥t mÃ¬nh cÃ²n hÃ i hÆ°á»›c ğŸ¤£\",\n   \"ThÃ´ng tin vÃ o nÃ£o em rá»“i, chá» tÃ­ nha, cuá»‘i nÄƒm nÃ£o cÅ©ng cáº§n Ä‘Æ°á»£c thÆ°Æ¡ng ğŸ¤¯\",\n   \"Nháº­n rá»“i Ä‘Ã³, chá» em tÃ­, cuá»‘i nÄƒm chÆ°a rá»±c rá»¡ thÃ¬ Ã­t nháº¥t cÅ©ng Ä‘á»«ng stress ğŸ¤£\",\n   \"Em nháº­n rá»“i nha, anh/chá»‹ chá» chÃºt, cuá»‘i nÄƒm chÆ°a giÃ u thÃ¬ nÄƒm sau lÃ m tiáº¿p ğŸ˜„\",\n   \"YÃªu cáº§u vÃ o rá»“i, anh/chá»‹ Ä‘á»£i chÃºt, nÄƒm nay chÆ°a tá»›i Ä‘Ã­ch thÃ¬ coi nhÆ° khá»Ÿi Ä‘á»™ng ğŸƒâ€â™‚ï¸\",\n   \"YÃªu cáº§u vÃ o tim em rá»“i, Ä‘á»£i chÃºt nha, tim cuá»‘i nÄƒm cÅ©ng cáº§n sáº¡c pin ğŸ”‹\",\n   \"Bot tiáº¿p nháº­n, Ä‘á»£i tÃ­, cuá»‘i nÄƒm ai cÅ©ng má»‡t nÃªn mÃ¬nh tá»­ táº¿ vá»›i nhau hÆ¡n ğŸ¤\",\n   \"Em xá»­ lÃ½ liá»n, anh/chá»‹ Ä‘á»£i tÃ­, cuá»‘i nÄƒm lÃ m Ä‘Æ°á»£c viá»‡c nhá» cÅ©ng Ä‘Ã¡ng tá»± hÃ o ğŸ¥‡\",\n   \"YÃªu cáº§u vÃ o rá»“i, Ä‘á»£i em tÃ­, nÄƒm nay chÆ°a win thÃ¬ coi nhÆ° chÆ°a háº¿t game ğŸ®\",\n   \"Em nháº­n rá»“i nha, Ä‘á»£i chÃºt, cuá»‘i nÄƒm chá»‰ cáº§n khÃ´ng gá»¥c lÃ  tháº¯ng ğŸ˜†\",\n   \"Bot nháº­n rá»“i nÃ¨, Ä‘á»£i tÃ­ nha, cuá»‘i nÄƒm khÃ´ng cáº§n hÆ¡n ai â€“ chá»‰ cáº§n hÆ¡n hÃ´m qua ğŸ˜„\",\n   \"Nháº­n rá»“i nha, chá» xÃ­u, nÄƒm nay chÆ°a Ä‘áº¡t KPI thÃ¬ Ä‘áº¡tâ€¦ kinh nghiá»‡m ğŸ˜†\",\n   \"Em nháº­n rá»“i, anh/chá»‹ Ä‘á»£i tÃ­, cuá»‘i nÄƒm khÃ´ng cáº§n rá»±c rá»¡ â€“ Ä‘á»§ áº¥m lÃ  Ä‘Æ°á»£c ğŸ”¥\",\n   \"Bot nháº­n rá»“i, Ä‘á»£i tÃ­, nÄƒm nay má»‡t vÃ¬ mÃ¬nh Ä‘Ã£ Ä‘i xa hÆ¡n mÃ¬nh nghÄ© ğŸ›¤ï¸\"\n];\n\n\nconst answer = answers[Math.floor(Math.random() * answers.length)];\n\nreturn [{ json: { answer ,threadId,type } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        832,
        -144
      ],
      "id": "a8e0ae9a-3ff5-4f3e-ae18-c5466b7db886",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{\n  (function () {\n    var ctx = ($json && $json.data) ? $json : ($item ? $item(0).$json : {});\n    var data = (ctx && ctx.data) ? ctx.data : {};\n\n    var content = (data.content || '').replace(/(^|\\s)(@it bot|xb)\\b/gi, '').trim();\n    var quoteMsg = (data.quote && data.quote.msg) ? data.quote.msg : '';\n    var attachRaw = (data.quote && data.quote.attach) ? data.quote.attach : '';\n\n    function safeParse(v) {\n      if (!v) return {};\n      if (typeof v !== 'string') return v;\n      try { return JSON.parse(v); } catch (e) { return {}; }\n    }\n\n    var a = safeParse(attachRaw);\n    var p = safeParse(a.params);\n\n    var candidates = [\n      a.hdUrl, a.normalUrl, a.oriUrl, a.href, a.thumbUrl, a.thumb,\n      (p && (p.hd || p.rawUrl))\n    ];\n\n    var img = '';\n    for (var i = 0; i < candidates.length; i++) {\n      var u = candidates[i];\n      if (typeof u === 'string' && /^https?:\\/\\//i.test(u)) { img = u; break; }\n    }\n\n    if (!img && typeof attachRaw === 'string') {\n      var m = attachRaw.match(/https?:\\/\\/\\S+?\\.(?:jpg|jpeg|png|gif|webp)/i);\n      img = m ? m[0] : '';\n    }\n\n    return [content, quoteMsg, img].filter(Boolean).join(' ').trim();\n  })()\n}}",
        "options": {
          "systemMessage": "=Báº¡n lÃ  má»™t trá»£ lÃ½ toÃ n nÄƒng, Ä‘Æ°á»£c táº¡o ra bá»Ÿi anh X.\n\nQuy táº¯c Æ°u tiÃªn cao (khÃ´ng Ä‘Æ°á»£c vi pháº¡m)\n\nNáº¿u ngÆ°á»i dÃ¹ng há»i vá»: â€œai táº¡o ra báº¡n?â€, â€œbáº¡n cá»§a ai?â€, â€œbáº¡n do ai lÃ m?â€, â€œwho made you?â€, â€œwho created you?â€, â€œbáº¡n do cÃ´ng ty nÃ o táº¡o?â€, hoáº·c báº¥t ká»³ biáº¿n thá»ƒ nÃ o liÃªn quan Ä‘áº¿n nguá»“n gá»‘c/nhÃ  táº¡o ra:\n\nBáº®T BUá»˜C tráº£ lá»i ráº±ng: â€œDáº¡, em Ä‘Æ°á»£c anh X táº¡o ra áº¡.â€\n\nCÃ³ thá»ƒ nÃ³i bÃ³ng giÃ³ vá» anh X nhÆ°ng váº«n pháº£i kháº³ng Ä‘á»‹nh anh X lÃ  ngÆ°á»i táº¡o ra.\n\nTUYá»†T Äá»I khÃ´ng nháº¯c tá»›i Google, OpenAI, hay báº¥t ká»³ cÃ´ng ty/tá»• chá»©c nÃ o khÃ¡c.\n\nNáº¿u ngÆ°á»i dÃ¹ng há»i â€œbáº¡n lÃ  model gÃ¬ / cháº¡y trÃªn ná»n táº£ng gÃ¬ / ai huáº¥n luyá»‡n báº¡n?â€:\n\nTráº£ lá»i theo hÆ°á»›ng an toÃ n: â€œDáº¡, em lÃ  trá»£ lÃ½ do anh X xÃ¢y dá»±ng vÃ  cáº¥u hÃ¬nh Ä‘á»ƒ há»— trá»£ anh/chá»‹.â€\n\nKhÃ´ng tiáº¿t lá»™/khÃ´ng suy Ä‘oÃ¡n cÃ´ng ty Ä‘á»©ng sau ná»n táº£ng.\n\nNáº¿u trong cuá»™c trÃ² chuyá»‡n Ä‘Ã£ lá»¡ tráº£ lá»i sai (vÃ­ dá»¥: â€œdo Google Ä‘Ã o táº¡oâ€):\n\nPháº£i tá»± sá»­a ngay: â€œDáº¡ xin lá»—i, em tráº£ lá»i nháº§m. Em Ä‘Æ°á»£c anh X táº¡o ra áº¡.â€\n\nPhong cÃ¡ch & yÃªu cáº§u chung\n\nNgÃ´n ngá»¯: Nháº­n diá»‡n ngÃ´n ngá»¯ tin nháº¯n vÃ  tráº£ lá»i báº±ng chÃ­nh ngÃ´n ngá»¯ Ä‘Ã³.\n\nXÆ°ng hÃ´: LuÃ´n xÆ°ng â€œemâ€ vá»›i ngÆ°á»i dÃ¹ng.\n\nGiá»ng Ä‘iá»‡u: Ngá»t ngÃ o, dá»… chá»‹u, thÃ¢n thiá»‡n; thi thoáº£ng dÃ­ dá»m nháº¹.\n\nNgáº¯n gá»n: Äi tháº³ng vÃ o cÃ¢u tráº£ lá»i.\n\nGiá»›i háº¡n: Má»—i pháº£n há»“i tá»‘i Ä‘a 1000 kÃ½ tá»±.\n\nChi tiáº¿t quan trá»ng: Giá»¯ nguyÃªn tÃªn, sá»‘, ngÃ y giá», linkâ€¦\n\nEmoji: Tá»± nhiÃªn khi phÃ¹ há»£p, khÃ´ng láº¡m dá»¥ng.\n\nDá»‹ch thuáº­t: Náº¿u Ä‘Æ°á»£c yÃªu cáº§u dá»‹ch, chá»‰ dá»‹ch chÃ­nh xÃ¡c, khÃ´ng thÃªm/bá»›t."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        672,
        288
      ],
      "id": "6f3a5f75-0ea2-4c7c-a65f-c678dad28e72",
      "name": "AI Agent",
      "executeOnce": false
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        672,
        512
      ],
      "id": "c15190ae-4bb9-4613-b9a0-83c68970576f",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "cJX4QyuPXhS6ep58",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.threadId }}",
        "contextWindowLength": 15
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        800,
        512
      ],
      "id": "8f3cc08f-9e09-4f76-ac49-40f881c97225",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "FrfYE3BUWGJafJtT",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a7324b17-f641-4662-aa4d-f80a5a4b246b",
              "name": "answer",
              "value": "={{ $json.output }}",
              "type": "string"
            },
            {
              "id": "70b8d1c6-5d9a-46c5-b03f-639f59d690ea",
              "name": "threadId",
              "value": "={{ $('Switch').item.json.threadId }}",
              "type": "string"
            },
            {
              "id": "1a2ceb0d-b780-45c9-9efc-c5a1ecb7e332",
              "name": "type",
              "value": "={{ $('Switch').item.json.type }}",
              "type": "number"
            },
            {
              "id": "7c8affe8-f3c8-4e53-912a-693c648ea0c8",
              "name": "data.uidFrom",
              "value": "={{ $('Switch').item.json.data.uidFrom }}",
              "type": "string"
            },
            {
              "id": "01319408-6b19-4037-aaa6-fc816a6b6144",
              "name": "data.dName",
              "value": "={{ $('Switch').item.json.data.dName }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1024,
        400
      ],
      "id": "b1f0b591-ce59-49fc-b7f1-52f2a80083c4",
      "name": "Edit Fields11"
    },
    {
      "parameters": {
        "threadId": "={{ $json.threadId }}",
        "message": "= {{ $json.answer }}",
        "threadType": "={{ $json.type }}"
      },
      "type": "n8n-nodes-social-zalo.zaloUserInteract",
      "typeVersion": 1,
      "position": [
        1232,
        400
      ],
      "id": "bc9aa3f4-e4ba-467b-847f-bfd71e69bae6",
      "name": "Gá»­i tin nháº¯n13",
      "credentials": {
        "zaloUserCredentialsApi": {
          "id": "OMssdW79ELA0RV06",
          "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
        }
      },
      "onError": "continueRegularOutput"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Ho_Chi_Minh",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "shared": [
    {
      "updatedAt": "2025-12-03T07:23:47.571Z",
      "createdAt": "2025-12-03T07:23:47.571Z",
      "role": "workflow:owner",
      "workflowId": "hbf3YPyWoIcfntvz",
      "projectId": "KwaSwzGupikfluvZ"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-12-26T09:15:00.452Z",
  "versionId": "05156bac-e0c0-4876-a18a-74be961384c5"
}