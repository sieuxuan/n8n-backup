{
  "active": true,
  "activeVersion": {
    "updatedAt": "2025-12-06T08:38:16.040Z",
    "createdAt": "2025-12-06T08:38:16.040Z",
    "versionId": "8f404f70-753a-4a38-9d53-ac2234f42162",
    "workflowId": "jJZHdpvMYNCn4QoY",
    "nodes": [
      {
        "parameters": {
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "documentId": {
            "__rl": true,
            "value": "1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg",
            "mode": "list",
            "cachedResultName": "IT HELP DESK",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 1979763952,
            "mode": "list",
            "cachedResultName": "ADD NEW SUPPLIER",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg/edit#gid=1979763952"
          },
          "event": "rowAdded",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "typeVersion": 1,
        "position": [
          0,
          96
        ],
        "id": "5d8efb17-73a6-4076-97b5-af88ea636245",
        "name": "Google Sheets Trigger",
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "3KLUaAaxMncvxTT2",
            "name": "Google Sheets Trigger account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const data = items[items.length - 1].json;\n\nconst lines = [];\n\nlines.push(\"ğŸ“¢ [YÃŠU Cáº¦U Táº O NHÃ€ CUNG Cáº¤P Má»šI]\");\n\nif (data[\"SUPPLIER_ID\"]) lines.push(`ğŸ†” Supplier ID: ${data[\"SUPPLIER_ID\"]}`);\nif (data[\"USER NAME\"] || data[\"TEAM\"]) {\n  lines.push(`ğŸ‘¤ NgÆ°á»i gá»­i: ${data[\"USER NAME\"] || \"\"} (${data[\"TEAM\"] || \"\"})`);\n}\nif (data[\"Timestamp\"]) lines.push(`ğŸ•’ Thá»i gian gá»­i: ${data[\"Timestamp\"]}`);\nif (data[\"STATUS\"]) lines.push(`ğŸ“Œ Tráº¡ng thÃ¡i: ${data[\"STATUS\"]}`);\n\nif (data[\"TÃŠN CÃ”NG TY\"]) lines.push(`ğŸ¢ TÃªn cÃ´ng ty: ${data[\"TÃŠN CÃ”NG TY\"]}`);\nif (data[\"TÃŠN VIáº¾T Táº®T\"]) lines.push(`ğŸ”¤ Viáº¿t táº¯t: ${data[\"TÃŠN VIáº¾T Táº®T\"]}`);\nif (data[\"Äá»ŠA CHá»ˆ\"]) lines.push(`ğŸ“ Äá»‹a chá»‰: ${data[\"Äá»ŠA CHá»ˆ\"]}`);\n\nif (data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]) lines.push(`ğŸ“¦ Catalog: ${data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]}`);\nif (data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]) lines.push(`ğŸŒ Trong/NgoÃ i nÆ°á»›c: ${data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]}`);\n\nif (data[\"NGÆ¯á»œI LIÃŠN Láº C\"]) lines.push(`ğŸ“ LiÃªn há»‡: ${data[\"NGÆ¯á»œI LIÃŠN Láº C\"]}`);\nif (data[\"EMAIL\"]) lines.push(`âœ‰ï¸ Email: ${data[\"EMAIL\"]}`);\nif (data[\"CURRENCY\"]) lines.push(`ğŸ’± Loáº¡i tiá»n: ${data[\"CURRENCY\"]}`);\nif (data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]) lines.push(`ğŸ§¾ MST: ${data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]}`);\nif (data[\"PIC\"]) lines.push(`ğŸ‘¨â€ğŸ’¼ PIC: ${data[\"PIC\"]}`);\nif (data[\"FINISH TIME\"]) lines.push(`âœ… Thá»i gian hoÃ n thÃ nh: ${data[\"FINISH TIME\"]}`);\nif (data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]) lines.push(`ğŸ“ Ghi chÃº: ${data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]}`);\nif (data[\"TYPE\"]) lines.push(`ğŸ“‘ Loáº¡i NCC: ${data[\"TYPE\"]}`);\n\n// Káº¿t quáº£\nconst message = lines.join('\\n');\n\nreturn [\n  {\n    json: {\n      message: message\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          224,
          0
        ],
        "id": "e6f18307-c132-4410-a77c-150ccfec3efc",
        "name": "Code"
      },
      {
        "parameters": {
          "threadId": "4798747745907374032",
          "message": "={{ $json.message }}",
          "threadType": 1
        },
        "type": "n8n-nodes-social-zalo.zaloUserInteract",
        "typeVersion": 1,
        "position": [
          448,
          0
        ],
        "id": "37cd0eda-325e-4930-9c5e-7d9157281cd2",
        "name": "Gá»­i tin nháº¯n1",
        "credentials": {
          "zaloUserCredentialsApi": {
            "id": "OMssdW79ELA0RV06",
            "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
          }
        }
      },
      {
        "parameters": {
          "resource": "chatMessage",
          "chatId": {
            "__rl": true,
            "value": "19:50306837a8da409a8037298a6a62e68c@thread.v2",
            "mode": "id"
          },
          "contentType": "html",
          "message": "={{ $json.message }}",
          "options": {}
        },
        "type": "n8n-nodes-base.microsoftTeams",
        "typeVersion": 2,
        "position": [
          448,
          192
        ],
        "id": "6acd30fe-a93b-48d7-b1df-a392070742b0",
        "name": "Create chat message",
        "webhookId": "faf59007-3027-4e4f-b910-ecf2a74da822",
        "credentials": {
          "microsoftTeamsOAuth2Api": {
            "id": "Iqzyk9veJ1J8eXou",
            "name": "Microsoft Teams account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// ==== Helpers ====\nfunction esc(s = '') {\n  return String(s)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\nfunction row(label, val) {\n  if (val === undefined || val === null || String(val).trim() === '') return '';\n  return `\n    <tr>\n      <td style=\"padding:6px 8px; color:#555; white-space:nowrap;\">${label}</td>\n      <td style=\"padding:6px 8px;\">${val}</td>\n    </tr>`;\n}\n\n// ==== Data nguá»“n ====\nconst data = items[items.length - 1]?.json || {};\n\n// Chuáº©n hoÃ¡/escape\nconst supplierId   = data[\"SUPPLIER_ID\"]                 ? esc(data[\"SUPPLIER_ID\"]) : '';\nconst userName     = data[\"USER NAME\"]                   ? esc(data[\"USER NAME\"]) : '';\nconst teamName     = data[\"TEAM\"]                        ? esc(data[\"TEAM\"]) : '';\nconst sender       = (userName || teamName)\n  ? `${userName}${teamName ? ' (' + teamName + ')' : ''}`\n  : '';\nconst timestamp    = data[\"Timestamp\"]                    ? esc(data[\"Timestamp\"]) : '';\nconst status       = data[\"STATUS\"]                       ? esc(data[\"STATUS\"]) : '';\n\nconst companyName  = data[\"TÃŠN CÃ”NG TY\"]                  ? esc(data[\"TÃŠN CÃ”NG TY\"]) : '';\nconst shortName    = data[\"TÃŠN VIáº¾T Táº®T\"]                 ? esc(data[\"TÃŠN VIáº¾T Táº®T\"]) : '';\nconst address      = data[\"Äá»ŠA CHá»ˆ\"]                      ? esc(data[\"Äá»ŠA CHá»ˆ\"]) : '';\n\nconst catalogType  = data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"] ? esc(data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]) : '';\nconst domestic     = data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"] ? esc(data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]) : '';\n\nconst contact      = data[\"NGÆ¯á»œI LIÃŠN Láº C\"]               ? esc(data[\"NGÆ¯á»œI LIÃŠN Láº C\"]) : '';\nconst emailRaw     = data[\"EMAIL\"]                         ? String(data[\"EMAIL\"]).trim() : '';\nconst emailVal     = emailRaw ? `<a href=\"mailto:${esc(emailRaw)}\">${esc(emailRaw)}</a>` : '';\nconst currency     = data[\"CURRENCY\"]                      ? esc(data[\"CURRENCY\"]) : '';\nconst taxCode      = (data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"] ?? '') !== '' ? esc(data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]) : '';\nconst pic          = data[\"PIC\"]                           ? esc(data[\"PIC\"]) : '';\nconst finishTime   = data[\"FINISH TIME\"]                   ? esc(data[\"FINISH TIME\"]) : '';\nconst note         = data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]   ? esc(data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]) : '';\nconst typeVal      = data[\"TYPE\"]                          ? esc(data[\"TYPE\"]) : '';\n\n// ==== Build HTML card ====\nconst header = `\n  <div style=\"font-size:15px; margin:0 0 8px;\">\n    ğŸ“¢ <strong>YÃŠU Cáº¦U Táº O NHÃ€ CUNG Cáº¤P Má»šI</strong>\n  </div>`;\n\nconst table = `\n  <table style=\"border-collapse:collapse; width:100%; max-width:720px; background:#fff; border:1px solid #eee; border-radius:12px; overflow:hidden;\">\n    <tbody>\n      ${row('ğŸ†” <strong>Supplier ID</strong>', supplierId)}\n      ${row('ğŸ‘¤ <strong>NgÆ°á»i gá»­i</strong>', sender)}\n      ${row('ğŸ•’ <strong>Thá»i gian gá»­i</strong>', timestamp)}\n      ${row('ğŸ“Œ <strong>Tráº¡ng thÃ¡i</strong>', status)}\n\n      ${row('ğŸ¢ <strong>TÃªn cÃ´ng ty</strong>', companyName)}\n      ${row('ğŸ”¤ <strong>Viáº¿t táº¯t</strong>', shortName)}\n      ${row('ğŸ“ <strong>Äá»‹a chá»‰</strong>', address)}\n\n      ${row('ğŸ“¦ <strong>Catalog</strong>', catalogType)}\n      ${row('ğŸŒ <strong>Trong/NgoÃ i nÆ°á»›c</strong>', domestic)}\n\n      ${row('ğŸ“ <strong>LiÃªn há»‡</strong>', contact)}\n      ${row('âœ‰ï¸ <strong>Email</strong>', emailVal)}\n      ${row('ğŸ’± <strong>Loáº¡i tiá»n</strong>', currency)}\n      ${row('ğŸ§¾ <strong>MST</strong>', taxCode)}\n      ${row('ğŸ‘¨â€ğŸ’¼ <strong>PIC</strong>', pic)}\n      ${row('âœ… <strong>Thá»i gian hoÃ n thÃ nh</strong>', finishTime)}\n      ${row('ğŸ“ <strong>Ghi chÃº</strong>', note)}\n      ${row('ğŸ“‘ <strong>Loáº¡i NCC</strong>', typeVal)}\n    </tbody>\n  </table>`;\n\n// ==== Káº¿t quáº£ ====\nconst message = `\n  <div style=\"font-family:Segoe UI, Arial, sans-serif; line-height:1.4;\">\n    ${header}\n    ${table}\n  </div>`.replace(/\\n\\s+/g, '\\n').trim();\n\nreturn [{\n  json: {\n    message // HTML Ä‘á»ƒ gá»­i vá»›i contentType: \"html\"\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          224,
          192
        ],
        "id": "3107e683-5f51-46f9-b647-291d1822f2f0",
        "name": "Code1",
        "disabled": true
      }
    ],
    "connections": {
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Gá»­i tin nháº¯n1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Create chat message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Xuan Nguyen",
    "name": null,
    "description": null
  },
  "activeVersionId": "8f404f70-753a-4a38-9d53-ac2234f42162",
  "connections": {
    "Google Sheets Trigger": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Gá»­i tin nháº¯n1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Create chat message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-26T09:18:05.880Z",
  "id": "jJZHdpvMYNCn4QoY",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Notification Supplier",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg",
          "mode": "list",
          "cachedResultName": "IT HELP DESK",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1979763952,
          "mode": "list",
          "cachedResultName": "ADD NEW SUPPLIER",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg/edit#gid=1979763952"
        },
        "event": "rowAdded",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        0,
        96
      ],
      "id": "5d8efb17-73a6-4076-97b5-af88ea636245",
      "name": "Google Sheets Trigger",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "3KLUaAaxMncvxTT2",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const data = items[items.length - 1].json;\n\nconst lines = [];\n\nlines.push(\"ğŸ“¢ [YÃŠU Cáº¦U Táº O NHÃ€ CUNG Cáº¤P Má»šI]\");\n\nif (data[\"SUPPLIER_ID\"]) lines.push(`ğŸ†” Supplier ID: ${data[\"SUPPLIER_ID\"]}`);\nif (data[\"USER NAME\"] || data[\"TEAM\"]) {\n  lines.push(`ğŸ‘¤ NgÆ°á»i gá»­i: ${data[\"USER NAME\"] || \"\"} (${data[\"TEAM\"] || \"\"})`);\n}\nif (data[\"Timestamp\"]) lines.push(`ğŸ•’ Thá»i gian gá»­i: ${data[\"Timestamp\"]}`);\nif (data[\"STATUS\"]) lines.push(`ğŸ“Œ Tráº¡ng thÃ¡i: ${data[\"STATUS\"]}`);\n\nif (data[\"TÃŠN CÃ”NG TY\"]) lines.push(`ğŸ¢ TÃªn cÃ´ng ty: ${data[\"TÃŠN CÃ”NG TY\"]}`);\nif (data[\"TÃŠN VIáº¾T Táº®T\"]) lines.push(`ğŸ”¤ Viáº¿t táº¯t: ${data[\"TÃŠN VIáº¾T Táº®T\"]}`);\nif (data[\"Äá»ŠA CHá»ˆ\"]) lines.push(`ğŸ“ Äá»‹a chá»‰: ${data[\"Äá»ŠA CHá»ˆ\"]}`);\n\nif (data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]) lines.push(`ğŸ“¦ Catalog: ${data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]}`);\nif (data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]) lines.push(`ğŸŒ Trong/NgoÃ i nÆ°á»›c: ${data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]}`);\n\nif (data[\"NGÆ¯á»œI LIÃŠN Láº C\"]) lines.push(`ğŸ“ LiÃªn há»‡: ${data[\"NGÆ¯á»œI LIÃŠN Láº C\"]}`);\nif (data[\"EMAIL\"]) lines.push(`âœ‰ï¸ Email: ${data[\"EMAIL\"]}`);\nif (data[\"CURRENCY\"]) lines.push(`ğŸ’± Loáº¡i tiá»n: ${data[\"CURRENCY\"]}`);\nif (data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]) lines.push(`ğŸ§¾ MST: ${data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]}`);\nif (data[\"PIC\"]) lines.push(`ğŸ‘¨â€ğŸ’¼ PIC: ${data[\"PIC\"]}`);\nif (data[\"FINISH TIME\"]) lines.push(`âœ… Thá»i gian hoÃ n thÃ nh: ${data[\"FINISH TIME\"]}`);\nif (data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]) lines.push(`ğŸ“ Ghi chÃº: ${data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]}`);\nif (data[\"TYPE\"]) lines.push(`ğŸ“‘ Loáº¡i NCC: ${data[\"TYPE\"]}`);\n\n// Káº¿t quáº£\nconst message = lines.join('\\n');\n\nreturn [\n  {\n    json: {\n      message: message\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        224,
        0
      ],
      "id": "e6f18307-c132-4410-a77c-150ccfec3efc",
      "name": "Code"
    },
    {
      "parameters": {
        "threadId": "4798747745907374032",
        "message": "={{ $json.message }}",
        "threadType": 1
      },
      "type": "n8n-nodes-social-zalo.zaloUserInteract",
      "typeVersion": 1,
      "position": [
        448,
        0
      ],
      "id": "37cd0eda-325e-4930-9c5e-7d9157281cd2",
      "name": "Gá»­i tin nháº¯n1",
      "credentials": {
        "zaloUserCredentialsApi": {
          "id": "OMssdW79ELA0RV06",
          "name": "Zalo It Bot - 2025-12-06T08:34:23.063Z"
        }
      }
    },
    {
      "parameters": {
        "resource": "chatMessage",
        "chatId": {
          "__rl": true,
          "value": "19:50306837a8da409a8037298a6a62e68c@thread.v2",
          "mode": "id"
        },
        "contentType": "html",
        "message": "={{ $json.message }}",
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [
        448,
        192
      ],
      "id": "6acd30fe-a93b-48d7-b1df-a392070742b0",
      "name": "Create chat message",
      "webhookId": "faf59007-3027-4e4f-b910-ecf2a74da822",
      "credentials": {
        "microsoftTeamsOAuth2Api": {
          "id": "Iqzyk9veJ1J8eXou",
          "name": "Microsoft Teams account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// ==== Helpers ====\nfunction esc(s = '') {\n  return String(s)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\nfunction row(label, val) {\n  if (val === undefined || val === null || String(val).trim() === '') return '';\n  return `\n    <tr>\n      <td style=\"padding:6px 8px; color:#555; white-space:nowrap;\">${label}</td>\n      <td style=\"padding:6px 8px;\">${val}</td>\n    </tr>`;\n}\n\n// ==== Data nguá»“n ====\nconst data = items[items.length - 1]?.json || {};\n\n// Chuáº©n hoÃ¡/escape\nconst supplierId   = data[\"SUPPLIER_ID\"]                 ? esc(data[\"SUPPLIER_ID\"]) : '';\nconst userName     = data[\"USER NAME\"]                   ? esc(data[\"USER NAME\"]) : '';\nconst teamName     = data[\"TEAM\"]                        ? esc(data[\"TEAM\"]) : '';\nconst sender       = (userName || teamName)\n  ? `${userName}${teamName ? ' (' + teamName + ')' : ''}`\n  : '';\nconst timestamp    = data[\"Timestamp\"]                    ? esc(data[\"Timestamp\"]) : '';\nconst status       = data[\"STATUS\"]                       ? esc(data[\"STATUS\"]) : '';\n\nconst companyName  = data[\"TÃŠN CÃ”NG TY\"]                  ? esc(data[\"TÃŠN CÃ”NG TY\"]) : '';\nconst shortName    = data[\"TÃŠN VIáº¾T Táº®T\"]                 ? esc(data[\"TÃŠN VIáº¾T Táº®T\"]) : '';\nconst address      = data[\"Äá»ŠA CHá»ˆ\"]                      ? esc(data[\"Äá»ŠA CHá»ˆ\"]) : '';\n\nconst catalogType  = data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"] ? esc(data[\"CÃ”NG TY THUá»˜C CATALOG TYPE GÃŒ:\"]) : '';\nconst domestic     = data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"] ? esc(data[\"CÃ”NG TY LÃ€ TRONG NÆ¯á»šC HAY NÆ¯á»šC NGOÃ€I\"]) : '';\n\nconst contact      = data[\"NGÆ¯á»œI LIÃŠN Láº C\"]               ? esc(data[\"NGÆ¯á»œI LIÃŠN Láº C\"]) : '';\nconst emailRaw     = data[\"EMAIL\"]                         ? String(data[\"EMAIL\"]).trim() : '';\nconst emailVal     = emailRaw ? `<a href=\"mailto:${esc(emailRaw)}\">${esc(emailRaw)}</a>` : '';\nconst currency     = data[\"CURRENCY\"]                      ? esc(data[\"CURRENCY\"]) : '';\nconst taxCode      = (data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"] ?? '') !== '' ? esc(data[\"MÃƒ Sá» THUáº¾ CÃ”NG TY\"]) : '';\nconst pic          = data[\"PIC\"]                           ? esc(data[\"PIC\"]) : '';\nconst finishTime   = data[\"FINISH TIME\"]                   ? esc(data[\"FINISH TIME\"]) : '';\nconst note         = data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]   ? esc(data[\"THÃŠM Lá»œI NHáº®N NHá»¦ Vá»šI ADMIN\"]) : '';\nconst typeVal      = data[\"TYPE\"]                          ? esc(data[\"TYPE\"]) : '';\n\n// ==== Build HTML card ====\nconst header = `\n  <div style=\"font-size:15px; margin:0 0 8px;\">\n    ğŸ“¢ <strong>YÃŠU Cáº¦U Táº O NHÃ€ CUNG Cáº¤P Má»šI</strong>\n  </div>`;\n\nconst table = `\n  <table style=\"border-collapse:collapse; width:100%; max-width:720px; background:#fff; border:1px solid #eee; border-radius:12px; overflow:hidden;\">\n    <tbody>\n      ${row('ğŸ†” <strong>Supplier ID</strong>', supplierId)}\n      ${row('ğŸ‘¤ <strong>NgÆ°á»i gá»­i</strong>', sender)}\n      ${row('ğŸ•’ <strong>Thá»i gian gá»­i</strong>', timestamp)}\n      ${row('ğŸ“Œ <strong>Tráº¡ng thÃ¡i</strong>', status)}\n\n      ${row('ğŸ¢ <strong>TÃªn cÃ´ng ty</strong>', companyName)}\n      ${row('ğŸ”¤ <strong>Viáº¿t táº¯t</strong>', shortName)}\n      ${row('ğŸ“ <strong>Äá»‹a chá»‰</strong>', address)}\n\n      ${row('ğŸ“¦ <strong>Catalog</strong>', catalogType)}\n      ${row('ğŸŒ <strong>Trong/NgoÃ i nÆ°á»›c</strong>', domestic)}\n\n      ${row('ğŸ“ <strong>LiÃªn há»‡</strong>', contact)}\n      ${row('âœ‰ï¸ <strong>Email</strong>', emailVal)}\n      ${row('ğŸ’± <strong>Loáº¡i tiá»n</strong>', currency)}\n      ${row('ğŸ§¾ <strong>MST</strong>', taxCode)}\n      ${row('ğŸ‘¨â€ğŸ’¼ <strong>PIC</strong>', pic)}\n      ${row('âœ… <strong>Thá»i gian hoÃ n thÃ nh</strong>', finishTime)}\n      ${row('ğŸ“ <strong>Ghi chÃº</strong>', note)}\n      ${row('ğŸ“‘ <strong>Loáº¡i NCC</strong>', typeVal)}\n    </tbody>\n  </table>`;\n\n// ==== Káº¿t quáº£ ====\nconst message = `\n  <div style=\"font-family:Segoe UI, Arial, sans-serif; line-height:1.4;\">\n    ${header}\n    ${table}\n  </div>`.replace(/\\n\\s+/g, '\\n').trim();\n\nreturn [{\n  json: {\n    message // HTML Ä‘á»ƒ gá»­i vá»›i contentType: \"html\"\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        224,
        192
      ],
      "id": "3107e683-5f51-46f9-b647-291d1822f2f0",
      "name": "Code1",
      "disabled": true
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-08-26T09:18:05.880Z",
      "createdAt": "2025-08-26T09:18:05.880Z",
      "role": "workflow:owner",
      "workflowId": "jJZHdpvMYNCn4QoY",
      "projectId": "KwaSwzGupikfluvZ"
    }
  ],
  "staticData": {
    "node:Google Sheets Trigger": {
      "documentId": "1oIh0H_SIV0-TewfNrkGjCRlxS0Hl7ogN6a4HObMu4Vg",
      "sheetId": 1979763952,
      "lastIndexChecked": 303
    }
  },
  "tags": [
    {
      "updatedAt": "2025-08-26T09:13:10.458Z",
      "createdAt": "2025-08-26T09:13:10.458Z",
      "id": "B5xHSngQqVM1yV80",
      "name": "Notification"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-12-18T17:00:02.831Z",
  "versionId": "8f404f70-753a-4a38-9d53-ac2234f42162"
}